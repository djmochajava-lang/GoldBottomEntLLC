<!-- dashboard/roster.html â€” Talent Management -->
<div class="dashboard-page" id="dash-roster">
  <div class="dashboard-page-header">
    <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:var(--space-sm);">
      <div><h1>Roster Management</h1><p class="text-muted">Manage your artists, creatives, and developers.</p></div>
      <button class="btn btn-primary" id="add-talent-btn" style="display:inline-flex;align-items:center;gap:var(--space-xs);padding:var(--space-sm) var(--space-md);font-size:var(--text-sm);font-weight:var(--fw-semibold);color:var(--color-text-inverse);background:var(--color-gold);border-radius:var(--radius-sm);border:none;cursor:pointer;transition:background 150ms ease,transform 150ms ease;"><i class="fa-solid fa-plus"></i> Add Talent</button>
    </div>
  </div>

  <!-- Filter Bar -->
  <div id="roster-filters" style="display:flex;gap:var(--space-xs);margin-top:var(--space-lg);flex-wrap:wrap;">
    <button class="filter-btn active" data-filter="all" style="padding:var(--space-xs) var(--space-md);border-radius:var(--radius-full);font-size:var(--text-sm);font-weight:var(--fw-medium);border:1px solid var(--color-border);cursor:pointer;transition:all 150ms ease;">All</button>
    <button class="filter-btn" data-filter="artist" style="padding:var(--space-xs) var(--space-md);border-radius:var(--radius-full);font-size:var(--text-sm);font-weight:var(--fw-medium);border:1px solid var(--color-border);cursor:pointer;transition:all 150ms ease;">Artists</button>
    <button class="filter-btn" data-filter="creative" style="padding:var(--space-xs) var(--space-md);border-radius:var(--radius-full);font-size:var(--text-sm);font-weight:var(--fw-medium);border:1px solid var(--color-border);cursor:pointer;transition:all 150ms ease;">Creatives</button>
    <button class="filter-btn" data-filter="developer" style="padding:var(--space-xs) var(--space-md);border-radius:var(--radius-full);font-size:var(--text-sm);font-weight:var(--fw-medium);border:1px solid var(--color-border);cursor:pointer;transition:all 150ms ease;">Developers</button>
  </div>

  <!-- Roster Table -->
  <div class="card" id="roster-table-container" style="background:var(--color-bg-secondary);border:1px solid var(--color-border);border-radius:var(--radius-lg);padding:var(--space-lg);margin-top:var(--space-md);"></div>
</div>

<script>
(function(){
  if(typeof DataStore==='undefined')return;

  var isLocal = (typeof Auth !== 'undefined' && Auth.isLocalDashboard && Auth.isLocalDashboard());

  var currentFilter='all';

  /* ---- Category badge colors ---- */
  var catBadge={
    artist:  {label:'Artist',   bg:'rgba(184,134,11,0.15)',  color:'#d4a017'},
    creative:{label:'Creative', bg:'rgba(88,166,255,0.15)', color:'#58a6ff'},
    developer:{label:'Developer',bg:'rgba(63,185,80,0.15)', color:'#3fb950'}
  };

  /* ---- Status pill colors ---- */
  var statusPill={
    active:  {label:'Active',   bg:'rgba(63,185,80,0.15)',  color:'#3fb950'},
    inactive:{label:'Inactive', bg:'rgba(139,148,158,0.15)',color:'#8b949e'},
    prospect:{label:'Prospect', bg:'rgba(210,153,34,0.15)', color:'#d29922'}
  };

  /* ---- Render table ---- */
  function renderTable(){
    var c=document.getElementById('roster-table-container');
    if(!c)return;
    var data=DataStore.getRoster();

    /* Apply filter */
    if(currentFilter!=='all'){
      data=data.filter(function(t){return t.category===currentFilter;});
    }

    if(!data.length){
      var emptyMsg=currentFilter==='all'?'No talent on the roster yet. Add your first member.':'No '+currentFilter+'s found.';
      c.innerHTML='<div class="empty-state" style="text-align:center;padding:var(--space-3xl) var(--space-lg);"><div class="empty-state-icon" style="font-size:var(--text-4xl);color:var(--color-text-muted);margin-bottom:var(--space-md);"><i class="fa-solid fa-users"></i></div><h3 class="empty-state-title" style="color:var(--color-text);margin-bottom:var(--space-sm);">No Roster Entries</h3><p class="empty-state-text" style="color:var(--color-text-secondary);font-size:var(--text-sm);">'+emptyMsg+'</p></div>';
      return;
    }

    var headers=['Name','Category','Genre / Skill','Status','Contract End'];
    if(isLocal) headers.push('Commission');
    headers.push('Contact');
    if(isLocal) headers.push('Actions');

    var html='<div style="overflow-x:auto;"><table class="data-table" style="width:100%;border-collapse:collapse;"><thead><tr style="text-align:left;border-bottom:2px solid var(--color-border);">';
    headers.forEach(function(h){
      html+='<th style="padding:var(--space-sm);font-size:var(--text-xs);text-transform:uppercase;letter-spacing:0.05em;color:var(--color-text-muted);font-weight:var(--fw-semibold);white-space:nowrap;">'+h+'</th>';
    });
    html+='</tr></thead><tbody>';

    data.forEach(function(t){
      var cb=catBadge[t.category]||{label:t.category||'Other',bg:'rgba(139,148,158,0.15)',color:'#8b949e'};
      var sp=statusPill[t.status]||{label:t.status||'Unknown',bg:'rgba(139,148,158,0.15)',color:'#8b949e'};
      var contractEnd=t.contractEnd?Utils.formatDate(t.contractEnd):'\u2014';
      var contact=t.email?Utils.escapeHtml(t.email):'\u2014';

      html+='<tr style="border-bottom:1px solid var(--color-border);">'+
        '<td data-label="Name" style="padding:var(--space-sm);font-size:var(--text-sm);"><strong>'+Utils.escapeHtml(t.name)+'</strong></td>'+
        '<td data-label="Category" style="padding:var(--space-sm);"><span style="display:inline-block;padding:2px 10px;border-radius:var(--radius-full);font-size:var(--text-xs);font-weight:var(--fw-semibold);background:'+cb.bg+';color:'+cb.color+';">'+cb.label+'</span></td>'+
        '<td data-label="Genre / Skill" style="padding:var(--space-sm);font-size:var(--text-sm);color:var(--color-text-secondary);">'+(t.genre?Utils.escapeHtml(t.genre):'\u2014')+'</td>'+
        '<td data-label="Status" style="padding:var(--space-sm);"><span class="status-pill" style="display:inline-block;padding:2px 10px;border-radius:var(--radius-full);font-size:var(--text-xs);font-weight:var(--fw-semibold);background:'+sp.bg+';color:'+sp.color+';text-transform:capitalize;">'+sp.label+'</span></td>'+
        '<td data-label="Contract End" style="padding:var(--space-sm);font-size:var(--text-sm);color:var(--color-text-secondary);">'+contractEnd+'</td>'+
        (isLocal?'<td data-label="Commission" style="padding:var(--space-sm);font-size:var(--text-sm);color:var(--color-text-muted);">'+(t.commission?Utils.escapeHtml(t.commission)+'%':'\u2014')+'</td>':'')+
        '<td data-label="Contact" style="padding:var(--space-sm);font-size:var(--text-sm);color:var(--color-text-secondary);">'+contact+'</td>'+
        (isLocal?'<td data-label="Actions" style="padding:var(--space-sm);"><div class="data-table-actions" style="display:flex;gap:var(--space-xs);">'+
          '<button class="btn btn-ghost btn-sm" onclick="editTalent(\''+t.id+'\')" style="padding:4px 8px;border-radius:var(--radius-sm);color:var(--color-text-secondary);background:none;border:none;cursor:pointer;" title="Edit"><i class="fa-solid fa-pen"></i></button>'+
          '<button class="btn btn-ghost btn-sm text-danger" onclick="deleteTalent(\''+t.id+'\')" style="padding:4px 8px;border-radius:var(--radius-sm);color:var(--color-danger);background:none;border:none;cursor:pointer;" title="Delete"><i class="fa-solid fa-trash"></i></button>'+
        '</div></td>':'')+
      '</tr>';
    });
    html+='</tbody></table></div>';
    c.innerHTML=html;
  }

  /* ---- Filter buttons ---- */
  var filterBar=document.getElementById('roster-filters');
  if(filterBar){
    filterBar.addEventListener('click',function(e){
      var btn=e.target.closest('.filter-btn');
      if(!btn)return;
      currentFilter=btn.getAttribute('data-filter')||'all';

      /* Update active state */
      filterBar.querySelectorAll('.filter-btn').forEach(function(b){
        var isActive=b===btn;
        b.classList.toggle('active',isActive);
        b.style.background=isActive?'var(--color-gold)':'none';
        b.style.color=isActive?'var(--color-text-inverse)':'var(--color-text-secondary)';
        b.style.borderColor=isActive?'var(--color-gold)':'var(--color-border)';
      });

      renderTable();
    });

    /* Set initial active styles */
    filterBar.querySelectorAll('.filter-btn').forEach(function(b){
      var isActive=b.classList.contains('active');
      b.style.background=isActive?'var(--color-gold)':'none';
      b.style.color=isActive?'var(--color-text-inverse)':'var(--color-text-secondary)';
      b.style.borderColor=isActive?'var(--color-gold)':'var(--color-border)';
    });
  }

  /* ---- Modal form HTML ---- */
  function talentFormHTML(data){
    var d=data||{};
    var esc=Utils.escapeHtml;
    return '<form id="modal-form">'+
      '<div style="display:grid;grid-template-columns:1fr 1fr;gap:var(--space-md);">'+
        '<div class="form-group"><label class="form-label" style="display:block;font-size:var(--text-sm);font-weight:var(--fw-medium);color:var(--color-text-secondary);margin-bottom:var(--space-xs);">Name *</label><input type="text" class="form-input" name="name" required placeholder="Full name" value="'+esc(d.name||'')+'" style="width:100%;padding:var(--space-sm);background:var(--color-bg-tertiary);border:1px solid var(--color-border);border-radius:var(--radius-sm);color:var(--color-text);font-size:var(--text-sm);" /></div>'+
        '<div class="form-group"><label class="form-label" style="display:block;font-size:var(--text-sm);font-weight:var(--fw-medium);color:var(--color-text-secondary);margin-bottom:var(--space-xs);">Category *</label><select class="form-select" name="category" required style="width:100%;padding:var(--space-sm);background:var(--color-bg-tertiary);border:1px solid var(--color-border);border-radius:var(--radius-sm);color:var(--color-text);font-size:var(--text-sm);">'+
          '<option value="artist"'+(d.category==='artist'?' selected':'')+'>Artist</option>'+
          '<option value="creative"'+(d.category==='creative'?' selected':'')+'>Creative</option>'+
          '<option value="developer"'+(d.category==='developer'?' selected':'')+'>Developer</option>'+
        '</select></div>'+
      '</div>'+
      '<div style="display:grid;grid-template-columns:1fr 1fr;gap:var(--space-md);margin-top:var(--space-md);">'+
        '<div class="form-group"><label class="form-label" style="display:block;font-size:var(--text-sm);font-weight:var(--fw-medium);color:var(--color-text-secondary);margin-bottom:var(--space-xs);">Genre / Skill</label><input type="text" class="form-input" name="genre" placeholder="e.g. Soul / Jazz / R&B" value="'+esc(d.genre||'')+'" style="width:100%;padding:var(--space-sm);background:var(--color-bg-tertiary);border:1px solid var(--color-border);border-radius:var(--radius-sm);color:var(--color-text);font-size:var(--text-sm);" /></div>'+
        '<div class="form-group"><label class="form-label" style="display:block;font-size:var(--text-sm);font-weight:var(--fw-medium);color:var(--color-text-secondary);margin-bottom:var(--space-xs);">Status</label><select class="form-select" name="status" style="width:100%;padding:var(--space-sm);background:var(--color-bg-tertiary);border:1px solid var(--color-border);border-radius:var(--radius-sm);color:var(--color-text);font-size:var(--text-sm);">'+
          '<option value="active"'+(d.status==='active'?' selected':'')+'>Active</option>'+
          '<option value="inactive"'+(d.status==='inactive'?' selected':'')+'>Inactive</option>'+
          '<option value="prospect"'+(!d.status||d.status==='prospect'?' selected':'')+'>Prospect</option>'+
        '</select></div>'+
      '</div>'+
      '<div style="display:grid;grid-template-columns:1fr 1fr;gap:var(--space-md);margin-top:var(--space-md);">'+
        '<div class="form-group"><label class="form-label" style="display:block;font-size:var(--text-sm);font-weight:var(--fw-medium);color:var(--color-text-secondary);margin-bottom:var(--space-xs);">Contract Start</label><input type="date" class="form-input" name="contractStart" value="'+(d.contractStart||'')+'" style="width:100%;padding:var(--space-sm);background:var(--color-bg-tertiary);border:1px solid var(--color-border);border-radius:var(--radius-sm);color:var(--color-text);font-size:var(--text-sm);" /></div>'+
        '<div class="form-group"><label class="form-label" style="display:block;font-size:var(--text-sm);font-weight:var(--fw-medium);color:var(--color-text-secondary);margin-bottom:var(--space-xs);">Contract End</label><input type="date" class="form-input" name="contractEnd" value="'+(d.contractEnd||'')+'" style="width:100%;padding:var(--space-sm);background:var(--color-bg-tertiary);border:1px solid var(--color-border);border-radius:var(--radius-sm);color:var(--color-text);font-size:var(--text-sm);" /></div>'+
      '</div>'+
      '<div style="margin-top:var(--space-md);padding-top:var(--space-md);border-top:1px solid rgba(255,255,255,0.08);"><h4 style="margin:0 0 var(--space-sm);font-size:var(--text-sm);color:var(--color-gold);font-weight:var(--fw-semibold);"><i class="fa-solid fa-guitar" style="margin-right:6px;"></i> Performance &amp; Logistics</h4></div>'+
      '<div style="display:grid;grid-template-columns:1fr 1fr;gap:var(--space-md);margin-top:var(--space-md);">'+
        '<div class="form-group"><label class="form-label" style="display:block;font-size:var(--text-sm);font-weight:var(--fw-medium);color:var(--color-text-secondary);margin-bottom:var(--space-xs);">Rate Type</label><select class="form-select" name="rateType" style="width:100%;padding:var(--space-sm);background:var(--color-bg-tertiary);border:1px solid var(--color-border);border-radius:var(--radius-sm);color:var(--color-text);font-size:var(--text-sm);">'+
          '<option value="flat"'+(d.rateType==='flat'?' selected':'')+'>Flat Rate</option>'+
          '<option value="hourly"'+(d.rateType==='hourly'?' selected':'')+'>Hourly</option>'+
        '</select></div>'+
        '<div class="form-group"><label class="form-label" style="display:block;font-size:var(--text-sm);font-weight:var(--fw-medium);color:var(--color-text-secondary);margin-bottom:var(--space-xs);">Standard Rate ($)</label><input type="number" class="form-input" name="standardRate" min="0" placeholder="0" value="'+esc(d.standardRate||'')+'" style="width:100%;padding:var(--space-sm);background:var(--color-bg-tertiary);border:1px solid var(--color-border);border-radius:var(--radius-sm);color:var(--color-text);font-size:var(--text-sm);" /></div>'+
      '</div>'+
      '<div style="display:grid;grid-template-columns:1fr 1fr;gap:var(--space-md);margin-top:var(--space-md);">'+
        '<div class="form-group"><label class="form-label" style="display:block;font-size:var(--text-sm);font-weight:var(--fw-medium);color:var(--color-text-secondary);margin-bottom:var(--space-xs);">Minimum Rate ($)</label><input type="number" class="form-input" name="minimumRate" min="0" placeholder="0" value="'+esc(d.minimumRate||'')+'" style="width:100%;padding:var(--space-sm);background:var(--color-bg-tertiary);border:1px solid var(--color-border);border-radius:var(--radius-sm);color:var(--color-text);font-size:var(--text-sm);" /></div>'+
        '<div class="form-group"><label class="form-label" style="display:block;font-size:var(--text-sm);font-weight:var(--fw-medium);color:var(--color-text-secondary);margin-bottom:var(--space-xs);">Deposit %</label><input type="number" class="form-input" name="depositPercent" min="0" max="100" placeholder="e.g. 30" value="'+esc(d.depositPercent||'')+'" style="width:100%;padding:var(--space-sm);background:var(--color-bg-tertiary);border:1px solid var(--color-border);border-radius:var(--radius-sm);color:var(--color-text);font-size:var(--text-sm);" /></div>'+
      '</div>'+
      '<div style="display:grid;grid-template-columns:1fr 1fr;gap:var(--space-md);margin-top:var(--space-md);">'+
        '<div class="form-group"><label class="form-label" style="display:block;font-size:var(--text-sm);font-weight:var(--fw-medium);color:var(--color-text-secondary);margin-bottom:var(--space-xs);">Travel Radius</label><input type="text" class="form-input" name="travelRadius" placeholder="e.g. 50 miles, Local Only, National" value="'+esc(d.travelRadius||'')+'" style="width:100%;padding:var(--space-sm);background:var(--color-bg-tertiary);border:1px solid var(--color-border);border-radius:var(--radius-sm);color:var(--color-text);font-size:var(--text-sm);" /></div>'+
        '<div class="form-group"><label class="form-label" style="display:block;font-size:var(--text-sm);font-weight:var(--fw-medium);color:var(--color-text-secondary);margin-bottom:var(--space-xs);">Availability Status</label><select class="form-select" name="availabilityStatus" style="width:100%;padding:var(--space-sm);background:var(--color-bg-tertiary);border:1px solid var(--color-border);border-radius:var(--radius-sm);color:var(--color-text);font-size:var(--text-sm);">'+
          '<option value="available"'+(!d.availabilityStatus||d.availabilityStatus==='available'?' selected':'')+'>Available</option>'+
          '<option value="booked"'+(d.availabilityStatus==='booked'?' selected':'')+'>Booked</option>'+
          '<option value="onhold"'+(d.availabilityStatus==='onhold'?' selected':'')+'>On Hold</option>'+
        '</select></div>'+
      '</div>'+
      '<div class="form-group" style="margin-top:var(--space-md);"><label class="form-label" style="display:block;font-size:var(--text-sm);font-weight:var(--fw-medium);color:var(--color-text-secondary);margin-bottom:var(--space-xs);">Rider Requirements</label><textarea class="form-textarea" name="riderNeeds" rows="2" placeholder="e.g. 2x powered speakers, green room, 2 meals, parking for 2 vehicles" style="width:100%;padding:var(--space-sm);background:var(--color-bg-tertiary);border:1px solid var(--color-border);border-radius:var(--radius-sm);color:var(--color-text);font-size:var(--text-sm);resize:vertical;">'+esc(d.riderNeeds||'')+'</textarea></div>'+
      '<div class="form-group" style="margin-top:var(--space-md);"><label class="form-label" style="display:block;font-size:var(--text-sm);font-weight:var(--fw-medium);color:var(--color-text-secondary);margin-bottom:var(--space-xs);">No-Go Zones</label><textarea class="form-textarea" name="noGoZones" rows="1" placeholder="e.g. No outdoor events without covered stage" style="width:100%;padding:var(--space-sm);background:var(--color-bg-tertiary);border:1px solid var(--color-border);border-radius:var(--radius-sm);color:var(--color-text);font-size:var(--text-sm);resize:vertical;">'+esc(d.noGoZones||'')+'</textarea></div>'+
      '<div style="display:grid;grid-template-columns:1fr 1fr;gap:var(--space-md);margin-top:var(--space-md);">'+
        '<div class="form-group"><label class="form-label" style="display:block;font-size:var(--text-sm);font-weight:var(--fw-medium);color:var(--color-text-secondary);margin-bottom:var(--space-xs);">Email</label><input type="email" class="form-input" name="email" placeholder="email@example.com" value="'+esc(d.email||'')+'" style="width:100%;padding:var(--space-sm);background:var(--color-bg-tertiary);border:1px solid var(--color-border);border-radius:var(--radius-sm);color:var(--color-text);font-size:var(--text-sm);" /></div>'+
        '<div class="form-group"><label class="form-label" style="display:block;font-size:var(--text-sm);font-weight:var(--fw-medium);color:var(--color-text-secondary);margin-bottom:var(--space-xs);">Phone</label><input type="tel" class="form-input" name="phone" placeholder="(555) 123-4567" value="'+esc(d.phone||'')+'" style="width:100%;padding:var(--space-sm);background:var(--color-bg-tertiary);border:1px solid var(--color-border);border-radius:var(--radius-sm);color:var(--color-text);font-size:var(--text-sm);" /></div>'+
      '</div>'+
      '<div class="form-group" style="margin-top:var(--space-md);"><label class="form-label" style="display:block;font-size:var(--text-sm);font-weight:var(--fw-medium);color:var(--color-text-secondary);margin-bottom:var(--space-xs);">Bio</label><textarea class="form-textarea" name="bio" rows="2" placeholder="Brief biography or description" style="width:100%;padding:var(--space-sm);background:var(--color-bg-tertiary);border:1px solid var(--color-border);border-radius:var(--radius-sm);color:var(--color-text);font-size:var(--text-sm);resize:vertical;">'+esc(d.bio||'')+'</textarea></div>'+
      '<div class="form-group" style="margin-top:var(--space-md);"><label class="form-label" style="display:block;font-size:var(--text-sm);font-weight:var(--fw-medium);color:var(--color-text-secondary);margin-bottom:var(--space-xs);">Notes</label><textarea class="form-textarea" name="notes" rows="2" placeholder="Internal notes" style="width:100%;padding:var(--space-sm);background:var(--color-bg-tertiary);border:1px solid var(--color-border);border-radius:var(--radius-sm);color:var(--color-text);font-size:var(--text-sm);resize:vertical;">'+esc(d.notes||'')+'</textarea></div>'+
    '</form>';
  }

  /* ---- Collect form data ---- */
  function collectFormData(){
    var f=document.getElementById('modal-form');
    if(!f)return null;
    var d={};
    new FormData(f).forEach(function(v,k){d[k]=v;});
    return d;
  }

  /* ---- Hide Add Talent button when not local ---- */
  if(!isLocal){
    var addTalentBtn=document.getElementById('add-talent-btn');
    if(addTalentBtn) addTalentBtn.style.display='none';
  }

  /* ---- Add Talent ---- */
  document.getElementById('add-talent-btn').addEventListener('click',function(){
    if(typeof Modal==='undefined')return;
    Modal.open({
      title:'Add Talent',
      size:'lg',
      content:talentFormHTML({status:'prospect',category:'artist'}),
      saveText:'Add Talent',
      onSave:function(){
        var d=collectFormData();
        if(!d||!d.name){Toast.error('Name is required');return;}
        d.owner='Gold Bottom Ent LLC';
        DataStore.addTalent(d);
        Modal.close();
        Toast.success('Added: '+d.name);
        renderTable();
      }
    });
  });

  /* ---- Edit Talent ---- */
  window.editTalent=function(id){
    var t=DataStore.getTalent(id);
    if(!t||typeof Modal==='undefined')return;
    Modal.open({
      title:'Edit: '+t.name,
      size:'lg',
      content:talentFormHTML(t),
      saveText:'Save',
      onSave:function(){
        var d=collectFormData();
        if(!d)return;
        DataStore.updateTalent(id,d);
        Modal.close();
        Toast.success('Updated: '+(d.name||t.name));
        renderTable();
      }
    });
  };

  /* ---- Delete Talent ---- */
  window.deleteTalent=function(id){
    var t=DataStore.getTalent(id);
    if(!t)return;
    Modal.confirm('Delete "'+t.name+'" from the roster?',function(){
      DataStore.deleteTalent(id);
      Toast.success('Removed: '+t.name);
      renderTable();
    });
  };

  renderTable();
})();
</script>
